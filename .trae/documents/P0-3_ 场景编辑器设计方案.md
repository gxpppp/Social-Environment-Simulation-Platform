## P0-3: 场景编辑器 - 可视化配置界面

### 功能需求

#### 1. 向导式配置流程（5步骤）
- **步骤1: 基础配置** - 名称、描述、类型、时长
- **步骤2: 环境参数** - 人口、经济、文化、政策
- **步骤3: 规则设置** - 交互规则、事件规则、演化规则
- **步骤4: Agent分配** - 选择参与Agent、设置初始状态
- **步骤5: 预览验证** - 配置预览、验证、保存

#### 2. 场景类型模板
- **政策评估** - 评估政策影响
- **舆论演化** - 模拟观点传播
- **市场分析** - 市场竞争模拟
- **团队培训** - 团队协作训练

#### 3. 环境参数配置
- **人口结构** - 年龄、教育、收入分布
- **经济指标** - GDP、就业率、消费水平
- **文化背景** - 价值观、社会规范
- **政策环境** - 当前政策、法规

#### 4. 规则引擎配置
- **交互规则** - Agent间交互频率、方式
- **事件规则** - 外部事件触发条件
- **演化规则** - 观点变化速率、传播机制

#### 5. Agent分配
- 从角色库选择Agent
- 设置初始观点立场
- 配置初始关系网络

### 技术实现方案

#### 前端组件结构
```
components/
├── SceneEditor/
│   ├── index.tsx              # 主编辑器组件
│   ├── BasicConfig.tsx        # 基础配置
│   ├── EnvironmentConfig.tsx  # 环境参数配置
│   ├── RulesConfig.tsx        # 规则配置
│   ├── AgentAssignment.tsx    # Agent分配
│   └── ScenePreview.tsx       # 场景预览
```

#### 页面流程
1. 场景列表页 → 点击"创建场景"
2. 进入场景编辑器（5步骤向导）
3. 步骤1: 基础配置
4. 步骤2: 环境参数
5. 步骤3: 规则设置
6. 步骤4: Agent分配
7. 步骤5: 预览和保存

### 交互设计

#### 步骤导航
- 步骤条组件（Step）
- 支持前进/后退
- 步骤验证提示
- 进度保存

#### 表单验证
- 实时验证
- 错误提示
- 必填项标记

#### 配置预览
- 可视化展示配置
- 配置冲突检测
- 优化建议

### 数据结构

```typescript
interface SceneConfig {
  // 基础配置
  basic: {
    name: string;
    description: string;
    type: 'policy' | 'opinion' | 'market' | 'training';
    duration: number;      // 模拟时长（天）
    timeStep: 'day' | 'week' | 'month';
  };
  
  // 环境参数
  environment: {
    population: {
      total: number;
      ageDistribution: Record<string, number>;
      educationDistribution: Record<string, number>;
      incomeDistribution: Record<string, number>;
    };
    economy: {
      gdp: number;
      employmentRate: number;
      consumerConfidence: number;
    };
    culture: {
      values: string[];
      socialNorms: string[];
    };
    policy: {
      currentPolicies: string[];
      regulations: string[];
    };
  };
  
  // 规则配置
  rules: {
    interaction: {
      frequency: number;     // 交互频率
      channels: string[];    // 交互渠道
      influenceDecay: number; // 影响力衰减
    };
    events: {
      enabled: boolean;
      types: string[];
      probability: number;
    };
    evolution: {
      opinionChangeRate: number;
      networkEffect: number;
      stubbornness: number;
    };
  };
  
  // Agent分配
  agents: Array<{
    agentId: string;
    initialStance: number;   // 初始立场 -1到1
    initialConnections: string[];
    role: string;
  }>;
}
```

### 后端API扩展
- `GET /scenes/templates` - 获取场景模板
- `POST /scenes/validate` - 验证场景配置

请确认此设计方案后，我将立即开始实现代码。