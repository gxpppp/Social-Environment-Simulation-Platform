# 社会环境模拟平台 - 前端设计与开发

## 1. 设计系统概述

### 1.1 设计原则

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          前端设计原则                                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │  1. 清晰性 (Clarity)                                                 │   │
│  │     • 信息层级明确，用户能快速理解界面结构                              │   │
│  │     • 使用一致的视觉语言，减少认知负担                                  │   │
│  │     • 复杂数据可视化需要清晰的图例和说明                                │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │  2. 效率性 (Efficiency)                                              │   │
│  │     • 为专业用户提供快捷键和批量操作                                   │   │
│  │     • 常用功能不超过3次点击可达                                         │   │
│  │     • 实时反馈，操作结果立即可见                                        │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │  3. 一致性 (Consistency)                                             │   │
│  │     • 遵循Ant Design设计规范                                          │   │
│  │     • 跨页面组件行为一致                                                │   │
│  │     • 状态指示（加载、成功、错误）统一                                  │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │  4. 响应性 (Responsiveness)                                          │   │
│  │     • 实时数据更新，WebSocket推送                                     │   │
│  │     • 操作反馈时间 < 100ms                                            │   │
│  │     • 大数据量渲染使用虚拟滚动                                          │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │  5. 可访问性 (Accessibility)                                         │   │
│  │     • 支持键盘导航                                                      │   │
│  │     • 颜色对比度符合WCAG 2.1 AA标准                                     │   │
│  │     • 屏幕阅读器友好                                                    │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 1.2 色彩系统

```typescript
// 主题色彩配置
export const themeColors = {
  // 主色调 - 科技感蓝
  primary: {
    50: '#e6f7ff',
    100: '#bae7ff',
    200: '#91d5ff',
    300: '#69c0ff',
    400: '#40a9ff',
    500: '#1890ff',  // 主色
    600: '#096dd9',
    700: '#0050b3',
    800: '#003a8c',
    900: '#002766',
  },

  // 辅助色 - 数据可视化
  dataVisualization: {
    // 分类色板（用于区分不同Agent/群体）
    categorical: [
      '#1890ff', // 蓝
      '#52c41a', // 绿
      '#faad14', // 黄
      '#f5222d', // 红
      '#722ed1', // 紫
      '#13c2c2', // 青
      '#eb2f96', // 粉
      '#fa8c16', // 橙
      '#2f4554', // 灰蓝
      '#61a0a8', // 灰青
    ],
    // 连续色板（用于热力图、密度图）
    sequential: {
      blue: ['#e6f7ff', '#bae7ff', '#91d5ff', '#69c0ff', '#40a9ff', '#1890ff', '#096dd9', '#0050b3'],
      red: ['#fff1f0', '#ffccc7', '#ffa39e', '#ff7875', '#ff4d4f', '#f5222d', '#cf1322', '#a8071a'],
    },
    // 发散色板（用于正负值对比）
    diverging: ['#d73027', '#f46d43', '#fdae61', '#fee08b', '#ffffbf', '#d9ef8b', '#a6d96a', '#66bd63', '#1a9850'],
  },

  // 语义色
  semantic: {
    success: '#52c41a',
    warning: '#faad14',
    error: '#f5222d',
    info: '#1890ff',
    processing: '#1890ff',
  },

  // 中性色
  neutral: {
    white: '#ffffff',
    gray1: '#fafafa',
    gray2: '#f5f5f5',
    gray3: '#f0f0f0',
    gray4: '#d9d9d9',
    gray5: '#bfbfbf',
    gray6: '#8c8c8c',
    gray7: '#595959',
    gray8: '#434343',
    gray9: '#262626',
    black: '#000000',
  },

  // 深色模式专用
  dark: {
    bg: '#141414',
    surface: '#1f1f1f',
    border: '#434343',
    text: '#ffffff',
    textSecondary: 'rgba(255,255,255,0.65)',
  },
};
```

### 1.3 字体系统

```typescript
// 字体配置
export const typography = {
  // 中文字体栈
  fontFamily: {
    base: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif',
    mono: '"SF Mono", Monaco, "Cascadia Code", "Roboto Mono", Consolas, "Courier New", monospace',
  },

  // 字号层级
  fontSize: {
    h1: '38px',      // 页面标题
    h2: '30px',      // 区块标题
    h3: '24px',      // 卡片标题
    h4: '20px',      // 小标题
    h5: '16px',      // 列表标题
    body: '14px',    // 正文
    small: '12px',   // 辅助文字
    tiny: '10px',    // 标签/时间
  },

  // 行高
  lineHeight: {
    tight: 1.2,      // 标题
    normal: 1.5,     // 正文
    relaxed: 1.8,    // 长文本
  },

  // 字重
  fontWeight: {
    light: 300,
    regular: 400,
    medium: 500,
    semibold: 600,
    bold: 700,
  },
};
```

### 1.4 间距系统

```typescript
// 间距配置（基于8px网格）
export const spacing = {
  xs: '4px',
  sm: '8px',
  md: '16px',
  lg: '24px',
  xl: '32px',
  xxl: '48px',
  xxxl: '64px',
};

// 圆角
export const borderRadius = {
  sm: '2px',
  md: '4px',
  lg: '8px',
  xl: '16px',
  full: '9999px',
};

// 阴影
export const shadows = {
  sm: '0 1px 2px rgba(0,0,0,0.05)',
  md: '0 4px 6px rgba(0,0,0,0.1)',
  lg: '0 10px 15px rgba(0,0,0,0.1)',
  xl: '0 20px 25px rgba(0,0,0,0.15)',
  glow: '0 0 20px rgba(24,144,255,0.3)',  // 主色发光效果
};
```

---

## 2. 页面结构设计

### 2.1 信息架构

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              信息架构图                                              │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│  工作台 (Dashboard)                                                                  │
│  ├── 快速开始                                                                        │
│  │   ├── 创建新场景                                                                   │
│  │   ├── 从模板开始                                                                   │
│  │   └── 导入场景                                                                     │
│  ├── 最近项目                                                                        │
│  │   └── 场景卡片列表                                                                 │
│  ├── 运行中模拟                                                                      │
│  │   └── 实时状态监控                                                                 │
│  └── 系统公告/更新日志                                                               │
│                                                                                      │
│  场景管理 (Scenes)                                                                   │
│  ├── 场景列表                                                                        │
│  │   ├── 网格视图                                                                     │
│  │   └── 列表视图                                                                     │
│  ├── 场景编辑器                                                                      │
│  │   ├── 基础配置                                                                     │
│  │   ├── 环境参数                                                                     │
│  │   ├── 规则设置                                                                     │
│  │   └── 预览验证                                                                     │
│  └── 场景模板库                                                                      │
│      ├── 官方模板                                                                     │
│      ├── 社区模板                                                                     │
│      └── 我的模板                                                                     │
│                                                                                      │
│  角色管理 (Agents)                                                                   │
│  ├── 角色列表                                                                        │
│  ├── 角色编辑器                                                                      │
│  │   ├── 基础属性                                                                     │
│  │   ├── 人格特质 (Big Five)                                                         │
│  │   ├── 知识背景                                                                     │
│  │   ├── 行为模式                                                                     │
│  │   └── 记忆配置                                                                     │
│  ├── 角色模板                                                                        │
│  └── 批量导入/导出                                                                   │
│                                                                                      │
│  模拟控制 (Simulation)                                                               │
│  ├── 模拟配置                                                                        │
│  ├── 实时监控                                                                        │
│  │   ├── 网络关系图                                                                   │
│  │   ├── 时间轴事件流                                                                 │
│  │   ├── 指标仪表盘                                                                   │
│  │   └── Agent状态面板                                                                │
│  ├── 干预操作                                                                        │
│  │   ├── 注入事件                                                                     │
│  │   ├── 修改参数                                                                     │
│  │   └── 暂停/恢复/停止                                                              │
│  └── 历史回放                                                                        │
│                                                                                      │
│  分析中心 (Analytics)                                                                │
│  ├── 实时分析                                                                        │
│  │   ├── 网络演化                                                                     │
│  │   ├── 观点分布                                                                     │
│  │   └── 情感趋势                                                                     │
│  ├── 预测分析                                                                        │
│  │   ├── 趋势预测                                                                     │
│  │   ├── 情景对比                                                                     │
│  │   └── 敏感性分析                                                                   │
│  ├── 报告生成                                                                        │
│  │   ├── 自动报告                                                                     │
│  │   ├── 自定义报告                                                                   │
│  │   └── 导出 (PDF/PPT/Excel)                                                        │
│  └── 数据导出                                                                        │
│                                                                                      │
│  系统设置 (Settings)                                                                 │
│  ├── 个人设置                                                                        │
│  ├── 团队管理                                                                        │
│  ├── API密钥管理                                                                     │
│  ├── 模型配置                                                                        │
│  └── 使用统计                                                                        │
│                                                                                      │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

### 2.2 布局系统

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              页面布局结构                                            │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│  ┌─────────────────────────────────────────────────────────────────────────────────┐ │
│  │  Header (固定高度: 64px)                                                         │ │
│  │  ┌────────────┬───────────────────────────────────────────────┬──────────────┐ │ │
│  │  │  Logo      │  全局搜索                    通知  帮助  用户  │              │ │ │
│  │  │  (折叠菜单) │  (Cmd+K)                     🔔   ❓   👤   │              │ │ │
│  │  └────────────┴───────────────────────────────────────────────┴──────────────┘ │ │
│  └─────────────────────────────────────────────────────────────────────────────────┘ │
│                                          │                                           │
│  ┌────────────────────┐  ┌─────────────────────────────────────────────────────────┐ │
│  │  Sidebar           │  │  Main Content Area                                      │ │
│  │  (宽度: 200px)     │  │  (自适应宽度, min-width: 1024px)                        │ │
│  │  (可折叠)          │  │                                                         │ │
│  │                    │  │  ┌─────────────────────────────────────────────────────┐│ │
│  │  📊 工作台          │  │  │  Breadcrumb: 首页 > 场景管理 > 场景编辑器            ││ │
│  │  🎬 场景管理        │  │  └─────────────────────────────────────────────────────┘│ │
│  │  👤 角色管理        │  │                                                         │ │
│  │  ▶️ 模拟控制        │  │  ┌─────────────────────────────────────────────────────┐│ │
│  │  📈 分析中心        │  │  │                                                     ││ │
│  │  ⚙️ 系统设置        │  │  │                  页面主要内容                        ││ │
│  │                    │  │  │                                                     ││ │
│  │  ─────────────     │  │  │                                                     ││ │
│  │  💾 存储使用        │  │  │                                                     ││ │
│  │  ████████░░ 80%    │  │  │                                                     ││ │
│  │                    │  │  │                                                     ││ │
│  └────────────────────┘  │  └─────────────────────────────────────────────────────┘│ │
│                          │                                                         │ │
│                          └─────────────────────────────────────────────────────────┘ │
│                                                                                      │
│  断点设计:                                                                           │
│  • Desktop XL: ≥1920px (大屏展示更多数据列)                                         │
│  • Desktop: ≥1440px (标准桌面)                                                      │
│  • Laptop: ≥1280px (笔记本)                                                         │
│  • Tablet: ≥768px (平板，侧边栏变为抽屉)                                             │
│  • Mobile: <768px (手机，简化视图)                                                   │
│                                                                                      │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 3. 核心页面设计

### 3.1 工作台 (Dashboard)

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              工作台界面设计                                          │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│  ┌─────────────────────────────────────────────────────────────────────────────────┐ │
│  │  早上好，张研究员 👋                    当前时间: 2024-01-15 09:30               │ │
│  └─────────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                      │
│  ┌─────────────────────────────────────────────────────────────────────────────────┐ │
│  │  快速开始                                                    [v] 查看更多      │ │
│  ├─────────────────────────────────────────────────────────────────────────────────┤ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐            │ │
│  │  │   🆕        │  │   📋        │  │   📁        │  │   🎓        │            │ │
│  │  │  创建场景   │  │  选择模板   │  │  导入项目   │  │  查看教程   │            │ │
│  │  │             │  │             │  │             │  │             │            │ │
│  │  │ [开始创建]  │  │ [浏览模板]  │  │ [选择文件]  │  │ [开始学习]  │            │ │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘            │ │
│  └─────────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                      │
│  ┌─────────────────────────────────────────────────────────────────────────────────┐ │
│  │  最近项目                                           [创建场景] [导入] [管理]     │ │
│  ├─────────────────────────────────────────────────────────────────────────────────┤ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐            │ │
│  │  │ 📊 政策影响  │  │ 🗣️ 舆论演化  │  │ 🏢 市场竞争  │  │ ➕ 新建...  │            │ │
│  │  │   评估      │  │   模拟      │  │   分析      │  │             │            │ │
│  │  │             │  │             │  │             │  │             │            │ │
│  │  │ 状态: ✅ 完成│  │ 状态: 🔄 运行│  │ 状态: ⏸️ 暂停│  │             │            │ │
│  │  │ 更新: 2小时前│  │ 进度: 67%   │  │ 最后: 昨天  │  │             │            │ │
│  │  │             │  │             │  │             │  │             │            │ │
│  │  │ [查看报告]  │  │ [进入监控]  │  │ [继续模拟]  │  │             │            │ │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘            │ │
│  └─────────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                      │
│  ┌─────────────────────────────┐  ┌─────────────────────────────────────────────────┐ │
│  │  运行中模拟 (3)             │  │  使用统计                                       │ │
│  ├─────────────────────────────┤  ├─────────────────────────────────────────────────┤ │
│  │  🔄 舆论演化模拟    67%     │  │  ┌─────────────────────────────────────────┐     │ │
│  │     预计剩余: 15分钟        │  │  │  本月模拟次数          本月消耗Token      │     │ │
│  │     [查看] [暂停] [停止]    │  │  │                                         │     │ │
│  │                             │  │  │     24次                 1.2M           │     │ │
│  │  🔄 团队培训模拟    45%     │  │  │                                         │     │ │
│  │     预计剩余: 28分钟        │  │  │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │     │ │
│  │     [查看] [暂停] [停止]    │  │  │  较上月 +20%            较上月 +15%      │     │ │
│  │                             │  │  └─────────────────────────────────────────┘     │ │
│  │  🔄 新产品发布模拟  12%     │  │                                                  │ │
│  │     预计剩余: 52分钟        │  │  存储使用: ████████░░░░ 80% (8GB / 10GB)         │ │
│  │     [查看] [暂停] [停止]    │  │                                                  │ │
│  └─────────────────────────────┘  └─────────────────────────────────────────────────┘ │
│                                                                                      │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

### 3.2 场景编辑器 (Scene Editor)

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              场景编辑器界面设计                                      │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│  ┌─────────────────────────────────────────────────────────────────────────────────┐ │
│  │  💾 保存  [上次保存: 2分钟前]                              预览  验证  发布    │ │
│  └─────────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                      │
│  ┌────────────────────┐  ┌─────────────────────────────────────────────────────────┐ │
│  │  配置步骤          │  │  Step 1: 基础配置                                       │ │
│  │                    │  │  ═══════════════════════════════════════════════════   │ │
│  │  1. 基础配置   ●   │  │                                                         │ │
│  │  2. 环境参数   ○   │  │  场景名称 *                                             │ │
│  │  3. 角色配置   ○   │  │  ┌─────────────────────────────────────────────────┐   │ │
│  │  4. 规则设置   ○   │  │  │ 政策影响评估 - 新能源汽车补贴政策                  │   │ │
│  │  5. 预览验证   ○   │  │  └─────────────────────────────────────────────────┘   │ │
│  │                    │  │                                                         │ │
│  │  ─────────────     │  │  场景描述                                               │ │
│  │                    │  │  ┌─────────────────────────────────────────────────┐   │ │
│  │  场景类型          │  │  │ 模拟新能源汽车补贴政策发布后的社会反应...          │   │ │
│  │  ● 政策评估        │  │  │                                                  │   │ │
│  │  ○ 舆论演化        │  │  │                                                  │   │ │
│  │  ○ 市场分析        │  │  └─────────────────────────────────────────────────┘   │ │
│  │  ○ 团队培训        │  │                                                         │ │
│  │                    │  │  模拟时长                                               │ │
│  │                    │  │  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐   │ │
│  │                    │  │  │  30天   │  │  90天   │  │  180天  │  │ 自定义  │   │ │
│  │                    │  │  │  ●      │  │  ○      │  │  ○      │  │  ○      │   │ │
│  │                    │  │  └─────────┘  └─────────┘  └─────────┘  └─────────┘   │ │
│  │                    │  │                                                         │ │
│  │                    │  │  时间步长                                               │ │
│  │                    │  │  ┌─────────┐  ┌─────────┐  ┌─────────┐                 │ │
│  │                    │  │  │  1天    │  │  1周    │  │  1月    │                 │ │
│  │                    │  │  │  ●      │  │  ○      │  │  ○      │                 │ │
│  │                    │  │  └─────────┘  └─────────┘  └─────────┘                 │ │
│  │                    │  │                                                         │ │
│  │                    │  │  可见性                                                 │ │
│  │                    │  │  ○ 私有    ● 团队共享    ○ 公开                        │ │
│  │                    │  │                                                         │ │
│  │                    │  │  标签                                                   │ │
│  │                    │  │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐      │ │
│  │                    │  │  │ 政策    │ │ 新能源  │ │ 经济    │ │ + 添加  │      │ │
│  │                    │  │  └─────────┘ └─────────┘ └─────────┘ └─────────┘      │ │
│  │                    │  │                                                         │ │
│  │                    │  │  ┌─────────────────────────────────────────────────┐   │ │
│  │                    │  │  │  [取消]                    [下一步: 环境参数 →]  │   │ │
│  │                    │  │  └─────────────────────────────────────────────────┘   │ │
│  └────────────────────┘  └─────────────────────────────────────────────────────────┘ │
│                                                                                      │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

### 3.3 模拟监控界面 (Simulation Monitor)

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              模拟监控界面设计                                        │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│  ┌─────────────────────────────────────────────────────────────────────────────────┐ │
│  │  🎬 政策影响评估模拟                                    状态: 🔄 运行中  67%    │ │
│  │  Tick: 67/100  │  模拟时间: 第67天  │  运行时长: 23:45:12                        │ │
│  │                                                                                 │ │
│  │  [⏸️ 暂停] [▶️ 恢复] [⏹️ 停止] [⚡ 加速] [🐌 减速] [📷 快照] [📊 分析]          │ │
│  └─────────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                      │
│  ┌─────────────────────────────────────────────────────────────────────────────────┐ │
│  │  视图切换: [网络图] [时间轴] [统计面板] [Agent列表] [地图视图]                   │ │
│  └─────────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                      │
│  ┌─────────────────────────────────────────────────────────────────────────────────┐ │
│  │                                                                                 │ │
│  │                         社会网络关系图 (力导向布局)                              │ │
│  │                                                                                 │ │
│  │                    ○───○         ○────○                                        │ │
│  │                   /│   │\       /│    │\                                       │ │
│  │                  ○ │   │ ○────○ │    │ ○                                       │ │
│  │                  │ ○───○ │      │ ○──┬┘ │                                       │ │
│  │                  │/     \│      │/   │  │                                       │ │
│  │                  ○       ○──────○    │  ○                                       │ │
│  │                  │\     /│           │ /                                        │ │
│  │                  │ ○───○ │           ○○                                         │ │
│  │                  ○ │   │ ○                                                      │ │
│  │                   \│   │/                                                       │ │
│  │                    ○───○                                                        │ │
│  │                                                                                 │ │
│  │  图例: ● 支持者(45%)  ● 反对者(30%)  ● 中立者(25%)  ─ 强关系  - - 弱关系         │ │
│  │                                                                                 │ │
│  │  选中: Agent #23 "李明" - 中年工程师 - 支持度: 0.72                              │ │
│  │  最近行为: 在社交媒体发表了3条支持性评论                                         │ │
│  │                                                                                 │ │
│  └─────────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                      │
│  ┌─────────────────────────────┐  ┌─────────────────────────────────────────────────┐ │
│  │  实时指标                   │  │  最近事件                                       │ │
│  ├─────────────────────────────┤  ├─────────────────────────────────────────────────┤ │
│  │  支持率趋势                 │  │  🕐 09:32:15  Agent #45 发布了反对观点          │ │
│  │  ████████████████████░░░░   │  │     "补贴力度不够，实际效果有限"                 │ │
│  │  67% ▲ +5% (vs 昨天)        │  │                                                 │ │
│  │                             │  │  🕐 09:28:42  Agent #12 影响了 Agent #34         │ │
│  │  观点分布                   │  │     态度转变: 中立 → 支持                        │ │
│  │  ┌─────────────────────┐    │  │                                                 │ │
│  │  │  ████████░░░░░░░░░░ │    │  │  🕐 09:25:10  外部事件: 媒体报道政策细节         │ │
│  │  │  █████░░░░░░░░░░░░░ │    │  │     影响范围: 23个Agent                        │ │
│  │  │  ██████░░░░░░░░░░░░ │    │  │                                                 │ │
│  │  └─────────────────────┘    │  │  🕐 09:20:55  Agent #8 与 Agent #15 发生争论     │ │
│  │  支持 反对 中立             │  │     主题: 补贴对环境影响                         │ │
│  │                             │  │                                                 │ │
│  │  网络密度: 0.34 ▲ +0.02     │  │  ─────────────────────────────────────────────  │ │
│  │  聚类系数: 0.56             │  │  注入事件: [选择事件类型 ▼] [执行]               │ │
│  └─────────────────────────────┘  └─────────────────────────────────────────────────┘ │
│                                                                                      │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

### 3.4 分析中心 (Analytics)

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              分析中心界面设计                                        │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│  ┌─────────────────────────────────────────────────────────────────────────────────┐ │
│  │  分析中心: 政策影响评估模拟                                                      │ │
│  │  时间范围: 2024-01-01 至 2024-03-31 (90天)                                       │ │
│  │                                                                                 │ │
│  │  [实时分析] [预测分析] [情景对比] [报告生成]                                     │ │
│  └─────────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                      │
│  ┌─────────────────────────────────────────────────────────────────────────────────┐ │
│  │  观点演化趋势                                                                    │ │
│  │  ═══════════════════════════════════════════════════════════════════════════   │ │
│  │                                                                                 │ │
│  │  100%│                              ╭─╮                                        │ │
│  │      │                           ╭──╯ ╰──╮                                     │ │
│  │   80%│      ╭──╮               ╭╯       ╰╮    ╭──╮                            │ │
│  │      │   ╭──╯  ╰──╮          ╭╯          ╰───╯   ╰──                          │ │
│  │   60%│───╯        ╰──────────╯                      ╰─── 支持                  │ │
│  │      │                                          ╭──╮      反对                 │ │
│  │   40%│                                    ╭────╯   ╰──── 中立                 │ │
│  │      │                               ╭────╯                                   │ │
│  │   20%│                          ╭────╯                                         │ │
│  │      │                     ╭────╯                                              │ │
│  │    0%└────────────────────────────────────────────────────────────────         │ │
│  │       1月1日  1月15日  2月1日  2月15日  3月1日  3月15日  3月31日                │ │
│  │                                                                                 │ │
│  │  关键节点:                                                                      │ │
│  │  📍 1月20日 - 媒体报道引发关注峰值                                              │ │
│  │  📍 2月5日  - 专家解读后支持率回升                                              │ │
│  │  📍 2月28日 - 实施细节公布后趋于稳定                                            │ │
│  └─────────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                      │
│  ┌─────────────────────────────┐  ┌─────────────────────────────────────────────────┐ │
│  │  影响力排行榜               │  │  传播路径分析                                   │ │
│  ├─────────────────────────────┤  ├─────────────────────────────────────────────────┤ │
│  │  Top 10 最具影响力Agent     │  │                                                 │ │
│  │                             │  │     源头事件                                    │ │
│  │  1. 👤 王专家    影响: 234  │  │        │                                       │ │
│  │  2. 👤 李记者    影响: 189  │  │        ▼                                       │ │
│  │  3. 👤 张博主    影响: 156  │  │    ┌───┴───┐                                   │ │
│  │  4. 👤 陈学者    影响: 142  │  │    ▼       ▼                                   │ │
│  │  5. 👤 刘市民    影响: 128  │  │  ┌─┐     ┌─┐                                   │ │
│  │  ...                        │  │  └┬┘     └┬┘                                   │ │
│  │                             │  │   │\     /│                                    │ │
│  │  [查看完整列表]             │  │   │ \   / │                                    │ │
│  │                             │  │   ▼  ▼  ▼  ▼                                   │ │
│  └─────────────────────────────┘  │  最终影响: 156人                               │ │
│                                   │  平均传播深度: 3.2层                           │ │
│                                   │                                                 │ │
│                                   └─────────────────────────────────────────────────┘ │
│                                                                                      │
│  ┌─────────────────────────────────────────────────────────────────────────────────┐ │
│  │  预测分析 (基于当前趋势)                                                         │ │
│  │  ═══════════════════════════════════════════════════════════════════════════   │ │
│  │                                                                                 │ │
│  │  未来30天预测:                                                                  │ │
│  │  • 支持率: 67% → 72% (置信区间: 68%-76%)                                        │ │
│  │  • 反对率: 23% → 19% (置信区间: 15%-23%)                                        │ │
│  │  • 网络密度: 0.34 → 0.38 (社区结构更加紧密)                                      │ │
│  │                                                                                 │ │
│  │  情景对比:                                                                      │ │
│  │  如果发生以下事件，预测结果将变化:                                               │ │
│  │  ○ 正面媒体报道 (+5% 支持率)                                                    │ │
│  │  ○ 负面案例曝光 (-8% 支持率)                                                    │ │
│  │  ○ 政策调整公告 (±3% 视调整方向)                                                │ │
│  └─────────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                      │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 4. 交互设计规范

### 4.1 全局交互模式

| 交互类型 | 行为定义 | 视觉反馈 | 性能要求 |
|---------|---------|---------|---------|
| **页面加载** | 渐进式加载，优先显示框架 | Skeleton屏 → 内容淡入 | FCP < 1.5s, LCP < 2.5s |
| **数据加载** | 局部加载，不影响其他区域 | Spinner/Progress在数据区域 | 加载状态 < 300ms反馈 |
| **表单提交** | 异步提交，防重复点击 | 按钮Loading状态 + Toast提示 | 提交响应 < 500ms |
| **删除操作** | 二次确认，可撤销 | Modal确认 + 撤销Toast (5s) | 即时反馈 |
| **批量操作** | 选择 → 操作 → 确认 | 批量工具栏浮现 + 进度显示 | 支持取消 |
| **搜索过滤** | 实时搜索，防抖处理 | 输入时显示搜索中状态 | 防抖 300ms |
| **拖拽排序** | 视觉反馈 + 放置区域高亮 | Ghost元素 + 占位符 | 60fps动画 |
| **无限滚动** | 接近底部自动加载 | 底部Loading指示器 | 预加载阈值 200px |

### 4.2 键盘快捷键

```typescript
// 全局快捷键配置
export const keyboardShortcuts = {
  // 导航
  navigation: {
    'g d': '跳转到工作台 (Go Dashboard)',
    'g s': '跳转到场景管理 (Go Scenes)',
    'g a': '跳转到角色管理 (Go Agents)',
    'g m': '跳转到模拟控制 (Go Monitor)',
    'g n': '跳转到分析中心 (Go Analytics)',
  },

  // 操作
  actions: {
    'ctrl/cmd + k': '打开全局搜索',
    'ctrl/cmd + n': '新建场景',
    'ctrl/cmd + s': '保存当前编辑',
    'ctrl/cmd + z': '撤销',
    'ctrl/cmd + shift + z': '重做',
    'ctrl/cmd + f': '页面内搜索',
    'esc': '关闭弹窗/取消操作',
  },

  // 模拟控制
  simulation: {
    'space': '暂停/恢复模拟',
    '←': '后退一帧',
    '→': '前进一帧',
    'shift + →': '快进',
    'home': '跳到开始',
    'end': '跳到结束',
    'r': '重置模拟',
  },

  // 可视化
  visualization: {
    '+/=': '放大',
    '-': '缩小',
    '0': '重置视图',
    'f': '全屏模式',
    'h': '切换热力图',
  },
};
```

### 4.3 状态管理规范

```typescript
// 全局状态设计
interface AppState {
  // UI状态
  ui: {
    theme: 'light' | 'dark' | 'system';
    sidebarCollapsed: boolean;
    activeModal: string | null;
    notifications: Notification[];
    globalLoading: boolean;
  };

  // 用户状态
  auth: {
    user: User | null;
    isAuthenticated: boolean;
    permissions: string[];
    preferences: UserPreferences;
  };

  // 实时状态 (WebSocket)
  realtime: {
    connected: boolean;
    activeSimulations: Map<string, SimulationStatus>;
    unreadEvents: number;
  };
}

// 领域状态 - 按模块分离
interface SceneState {
  scenes: {
    list: Scene[];
    loading: boolean;
    pagination: PaginationState;
    filters: SceneFilter;
  };
  currentScene: {
    data: Scene | null;
    draft: SceneDraft | null;
    isDirty: boolean;
    saving: boolean;
    validationErrors: ValidationError[];
  };
  templates: {
    list: SceneTemplate[];
    categories: string[];
  };
}

interface SimulationState {
  sessions: Map<string, SimulationSession>;
  activeSessionId: string | null;
  viewState: {
    selectedView: 'network' | 'timeline' | 'metrics' | 'agents';
    selectedAgentId: string | null;
    timeRange: { start: number; end: number };
    playbackSpeed: number;
    isPlaying: boolean;
  };
  realtimeData: {
    events: SimulationEvent[];
    metrics: SimulationMetrics;
    agentStates: Map<string, AgentState>;
  };
}
```

---

## 5. 可视化组件设计

### 5.1 网络关系图组件

```typescript
// NetworkGraph组件接口定义
interface NetworkGraphProps {
  // 数据
  nodes: NetworkNode[];
  edges: NetworkEdge[];
  
  // 布局配置
  layout: {
    type: 'force' | 'circular' | 'hierarchical' | 'grid';
    options: LayoutOptions;
  };
  
  // 视觉配置
  visual: {
    nodeSize: number | ((node: NetworkNode) => number);
    nodeColor: string | ((node: NetworkNode) => string);
    edgeWidth: number | ((edge: NetworkEdge) => number);
    edgeColor: string | ((edge: NetworkEdge) => string);
    labelVisibility: 'all' | 'selected' | 'hover' | 'none';
  };
  
  // 交互配置
  interaction: {
    draggable: boolean;
    zoomable: boolean;
    selectable: boolean;
    hoverable: boolean;
    onNodeClick?: (node: NetworkNode, event: MouseEvent) => void;
    onNodeHover?: (node: NetworkNode | null) => void;
    onSelectionChange?: (selectedNodes: NetworkNode[]) => void;
  };
  
  // 性能配置
  performance: {
    maxNodes: number;
    maxEdges: number;
    useWebGL: boolean;
    enableClustering: boolean;
  };
}

// 使用示例
<NetworkGraph
  nodes={agents.map(a => ({
    id: a.id,
    label: a.name,
    group: a.attributes.politicalStance,
    size: a.influenceScore * 10,
    data: a,
  }))}
  edges={relationships.map(r => ({
    source: r.sourceId,
    target: r.targetId,
    weight: r.strength,
    type: r.type,
  }))}
  layout={{ type: 'force', options: { gravity: -1000, linkDistance: 100 } }}
  visual={{
    nodeColor: (node) => getStanceColor(node.group),
    nodeSize: (node) => Math.sqrt(node.size) * 5,
    labelVisibility: 'selected',
  }}
  interaction={{
    draggable: true,
    zoomable: true,
    onNodeClick: handleAgentSelect,
  }}
  performance={{
    maxNodes: 1000,
    useWebGL: true,
  }}
/>
```

### 5.2 时间轴组件

```typescript
// Timeline组件接口定义
interface TimelineProps {
  // 时间范围
  timeRange: {
    start: Date;
    end: Date;
    current: Date;
  };
  
  // 事件数据
  events: TimelineEvent[];
  
  // 显示配置
  display: {
    scale: 'day' | 'week' | 'month' | 'auto';
    eventHeight: number;
    laneHeight: number;
    showLabels: boolean;
    colorBy: 'type' | 'impact' | 'agent';
  };
  
  // 播放控制
  playback: {
    isPlaying: boolean;
    speed: number; // 1x, 2x, 5x, 10x
    onPlay: () => void;
    onPause: () => void;
    onSeek: (timestamp: Date) => void;
    onSpeedChange: (speed: number) => void;
  };
  
  // 事件渲染
  renderEvent?: (event: TimelineEvent) => React.ReactNode;
  
  // 回调
  onEventClick?: (event: TimelineEvent) => void;
  onEventHover?: (event: TimelineEvent | null) => void;
}

// 时间轴事件数据结构
interface TimelineEvent {
  id: string;
  timestamp: Date;
  type: 'interaction' | 'state_change' | 'external' | 'milestone';
  title: string;
  description: string;
  agents: string[];
  impact: 'low' | 'medium' | 'high' | 'critical';
  data: any;
}
```

### 5.3 实时指标仪表盘

```typescript
// MetricsDashboard组件
interface MetricsDashboardProps {
  // 指标配置
  metrics: MetricConfig[];
  
  // 数据更新
  data: Map<string, MetricData>;
  updateInterval: number;
  
  // 布局
  layout: 'grid' | 'list' | 'custom';
  columns: number;
  
  // 时间范围
  timeRange: {
    type: 'realtime' | '1h' | '24h' | '7d' | 'custom';
    start?: Date;
    end?: Date;
  };
}

interface MetricConfig {
  id: string;
  title: string;
  type: 'line' | 'bar' | 'pie' | 'number' | 'gauge' | 'heatmap';
  dataKey: string;
  unit?: string;
  thresholds?: {
    warning: number;
    critical: number;
  };
  aggregation?: 'sum' | 'avg' | 'max' | 'min' | 'count';
}

// 使用示例
const metrics: MetricConfig[] = [
  {
    id: 'support-rate',
    title: '支持率',
    type: 'gauge',
    dataKey: 'opinion.support.percentage',
    unit: '%',
    thresholds: { warning: 40, critical: 30 },
  },
  {
    id: 'network-density',
    title: '网络密度',
    type: 'line',
    dataKey: 'network.density',
    aggregation: 'avg',
  },
  {
    id: 'event-distribution',
    title: '事件分布',
    type: 'pie',
    dataKey: 'events.byType',
  },
  {
    id: 'active-agents',
    title: '活跃Agent数',
    type: 'number',
    dataKey: 'agents.active.count',
  },
];
```

---

## 6. 前端技术实现

### 6.1 项目架构

```
frontend/
├── apps/
│   └── web/                          # Web应用
│       ├── src/
│       │   ├── main.tsx              # 应用入口
│       │   ├── App.tsx               # 根组件
│       │   ├── routes/               # 路由配置
│       │   │   ├── index.tsx         # 路由定义
│       │   │   ├── guards/           # 路由守卫
│       │   │   └── lazy-components.ts # 懒加载配置
│       │   ├── layouts/              # 布局组件
│       │   │   ├── MainLayout.tsx    # 主布局
│       │   │   ├── AuthLayout.tsx    # 认证布局
│       │   │   └── components/       # 布局子组件
│       │   ├── pages/                # 页面组件
│       │   │   ├── Dashboard/        # 工作台
│       │   │   ├── Scenes/           # 场景管理
│       │   │   ├── Agents/           # 角色管理
│       │   │   ├── Simulation/       # 模拟控制
│       │   │   ├── Analytics/        # 分析中心
│       │   │   └── Settings/         # 系统设置
│       │   ├── components/           # 业务组件
│       │   │   ├── common/           # 通用组件
│       │   │   ├── visualization/    # 可视化组件
│       │   │   └── simulation/       # 模拟相关组件
│       │   ├── hooks/                # 自定义Hooks
│       │   ├── stores/               # 状态管理
│       │   ├── services/             # API服务
│       │   ├── utils/                # 工具函数
│       │   ├── types/                # 类型定义
│       │   └── styles/               # 全局样式
│       ├── index.html
│       └── vite.config.ts
│
├── packages/
│   ├── ui/                           # UI组件库
│   ├── visualization/                # 可视化引擎
│   ├── core/                         # 核心逻辑
│   └── types/                        # 共享类型
│
├── turbo.json
└── pnpm-workspace.yaml
```

### 6.2 核心Hooks实现

```typescript
// useSimulation.ts - 模拟状态管理Hook
export function useSimulation(sessionId: string) {
  const queryClient = useQueryClient();
  
  // 获取模拟会话信息
  const sessionQuery = useQuery({
    queryKey: ['simulation', sessionId],
    queryFn: () => simulationApi.getSession(sessionId),
    refetchInterval: (data) => 
      data?.status === 'running' ? 5000 : false,
  });

  // WebSocket实时数据
  const { lastMessage, sendMessage } = useWebSocket(
    `wss://api.example.com/simulations/${sessionId}/stream`,
    {
      onOpen: () => console.log('WebSocket connected'),
      onError: (error) => console.error('WebSocket error:', error),
      shouldReconnect: () => true,
    }
  );

  // 实时数据状态
  const [realtimeData, setRealtimeData] = useState<RealtimeData>({
    events: [],
    metrics: {},
    agentStates: new Map(),
  });

  // 处理WebSocket消息
  useEffect(() => {
    if (lastMessage) {
      const message = JSON.parse(lastMessage.data);
      handleRealtimeMessage(message, setRealtimeData);
    }
  }, [lastMessage]);

  // 控制操作
  const controls = {
    play: () => sendMessage(JSON.stringify({ action: 'play' })),
    pause: () => sendMessage(JSON.stringify({ action: 'pause' })),
    stop: () => sendMessage(JSON.stringify({ action: 'stop' })),
    seek: (tick: number) => 
      sendMessage(JSON.stringify({ action: 'seek', tick })),
    setSpeed: (speed: number) => 
      sendMessage(JSON.stringify({ action: 'speed', speed })),
    injectEvent: (event: EventConfig) => 
      sendMessage(JSON.stringify({ action: 'inject', event })),
  };

  return {
    session: sessionQuery.data,
    isLoading: sessionQuery.isLoading,
    realtimeData,
    controls,
  };
}

// useVisualization.ts - 可视化控制Hook
export function useVisualization(containerRef: RefObject<HTMLElement>) {
  const [viewState, setViewState] = useState<ViewState>({
    zoom: 1,
    pan: { x: 0, y: 0 },
    selectedNodes: [],
  });

  // 缩放控制
  const zoom = useCallback((delta: number, center?: Point) => {
    setViewState(prev => ({
      ...prev,
      zoom: clamp(prev.zoom * delta, 0.1, 5),
    }));
  }, []);

  // 平移控制
  const pan = useCallback((deltaX: number, deltaY: number) => {
    setViewState(prev => ({
      ...prev,
      pan: {
        x: prev.pan.x + deltaX,
        y: prev.pan.y + deltaY,
      },
    }));
  }, []);

  // 选择控制
  const selectNodes = useCallback((nodeIds: string[]) => {
    setViewState(prev => ({
      ...prev,
      selectedNodes: nodeIds,
    }));
  }, []);

  // 重置视图
  const resetView = useCallback(() => {
    setViewState({
      zoom: 1,
      pan: { x: 0, y: 0 },
      selectedNodes: [],
    });
  }, []);

  return {
    viewState,
    zoom,
    pan,
    selectNodes,
    resetView,
  };
}
```

### 6.3 性能优化策略

```typescript
// 虚拟滚动组件 - 用于大量Agent列表
export function VirtualAgentList({ agents }: { agents: Agent[] }) {
  const containerRef = useRef<HTMLDivElement>(null);
  const [visibleRange, setVisibleRange] = useState({ start: 0, end: 20 });
  
  const itemHeight = 60;
  const totalHeight = agents.length * itemHeight;
  
  useEffect(() => {
    const container = containerRef.current;
    if (!container) return;
    
    const handleScroll = () => {
      const scrollTop = container.scrollTop;
      const viewportHeight = container.clientHeight;
      
      const start = Math.floor(scrollTop / itemHeight);
      const end = Math.min(
        Math.ceil((scrollTop + viewportHeight) / itemHeight) + 2,
        agents.length
      );
      
      setVisibleRange({ start, end });
    };
    
    container.addEventListener('scroll', handleScroll);
    return () => container.removeEventListener('scroll', handleScroll);
  }, [agents.length]);
  
  const visibleAgents = agents.slice(visibleRange.start, visibleRange.end);
  const offsetY = visibleRange.start * itemHeight;
  
  return (
    <div ref={containerRef} style={{ height: '400px', overflow: 'auto' }}>
      <div style={{ height: totalHeight, position: 'relative' }}>
        <div style={{ transform: `translateY(${offsetY}px)` }}>
          {visibleAgents.map(agent => (
            <AgentCard key={agent.id} agent={agent} height={itemHeight} />
          ))}
        </div>
      </div>
    </div>
  );
}

// 数据分片加载 - 用于大量网络节点
export function useChunkedData<T>(
  fetchFn: (chunk: number) => Promise<T[]>,
  chunkSize: number = 100
) {
  const [data, setData] = useState<T[]>([]);
  const [loading, setLoading] = useState(false);
  const [hasMore, setHasMore] = useState(true);
  const chunkRef = useRef(0);
  
  const loadMore = useCallback(async () => {
    if (loading || !hasMore) return;
    
    setLoading(true);
    try {
      const chunk = await fetchFn(chunkRef.current);
      if (chunk.length < chunkSize) {
        setHasMore(false);
      }
      setData(prev => [...prev, ...chunk]);
      chunkRef.current++;
    } finally {
      setLoading(false);
    }
  }, [fetchFn, loading, hasMore, chunkSize]);
  
  return { data, loading, hasMore, loadMore };
}

// Web Worker用于复杂计算
export function useNetworkLayoutWorker() {
  const workerRef = useRef<Worker>();
  
  useEffect(() => {
    workerRef.current = new Worker(
      new URL('../workers/network-layout.worker.ts', import.meta.url)
    );
    
    return () => workerRef.current?.terminate();
  }, []);
  
  const calculateLayout = useCallback((nodes: Node[], edges: Edge[]) => {
    return new Promise<LayoutResult>((resolve) => {
      const worker = workerRef.current;
      if (!worker) return;
      
      const handleMessage = (e: MessageEvent) => {
        resolve(e.data);
        worker.removeEventListener('message', handleMessage);
      };
      
      worker.addEventListener('message', handleMessage);
      worker.postMessage({ nodes, edges });
    });
  }, []);
  
  return { calculateLayout };
}
```

---

## 7. 响应式设计

### 7.1 断点与布局适配

```typescript
// 断点定义
export const breakpoints = {
  xs: 480,   // 手机
  sm: 768,   // 平板
  md: 1024,  // 小桌面
  lg: 1280,  // 标准桌面
  xl: 1440,  // 大桌面
  xxl: 1920, // 超大屏
};

// 响应式工具Hook
export function useResponsive() {
  const [windowWidth, setWindowWidth] = useState(window.innerWidth);
  
  useEffect(() => {
    const handleResize = () => setWindowWidth(window.innerWidth);
    window.addEventListener('resize', handleResize);
    return () => window.removeEventListener('resize', handleResize);
  }, []);
  
  return {
    width: windowWidth,
    isMobile: windowWidth < breakpoints.sm,
    isTablet: windowWidth >= breakpoints.sm && windowWidth < breakpoints.md,
    isDesktop: windowWidth >= breakpoints.md,
    isLargeDesktop: windowWidth >= breakpoints.xl,
    breakpoints,
  };
}

// 响应式布局组件
export function ResponsiveLayout({
  children,
  sidebar,
  main,
}: {
  children: React.ReactNode;
  sidebar: React.ReactNode;
  main: React.ReactNode;
}) {
  const { isMobile, isTablet } = useResponsive();
  const [drawerOpen, setDrawerOpen] = useState(false);
  
  if (isMobile) {
    return (
      <div>
        <MobileHeader onMenuClick={() => setDrawerOpen(true)} />
        <Drawer
          open={drawerOpen}
          onClose={() => setDrawerOpen(false)}
          placement="left"
        >
          {sidebar}
        </Drawer>
        <main>{main}</main>
      </div>
    );
  }
  
  if (isTablet) {
    return (
      <div style={{ display: 'flex' }}>
        <Sider width={80} collapsed>{sidebar}</Sider>
        <main style={{ flex: 1 }}>{main}</main>
      </div>
    );
  }
  
  return (
    <div style={{ display: 'flex' }}>
      <Sider width={200}>{sidebar}</Sider>
      <main style={{ flex: 1 }}>{main}</main>
    </div>
  );
}
```

### 7.2 移动端适配策略

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              移动端界面适配                                          │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                      │
│  工作台 (移动端简化版)                                                               │
│  ┌─────────────────────────────────────────────────────────────────────────────────┐ │
│  │  ≡  SESP                    🔍         🔔                                       │ │
│  ├─────────────────────────────────────────────────────────────────────────────────┤ │
│  │  早上好，张研究员 👋                                                              │ │
│  │  ┌─────────────────────────────────────────────────────────────────────────┐   │ │
│  │  │  🆕 快速创建场景                                                         │   │ │
│  │  └─────────────────────────────────────────────────────────────────────────┘   │ │
│  │                                                                                 │ │
│  │  最近项目                                                                       │ │
│  │  ┌─────────────────────────────────────────────────────────────────────────┐   │ │
│  │  │ 📊 政策影响评估                                          状态: ✅      │   │ │
│  │  │    更新: 2小时前                                          [查看]       │   │ │
│  │  ├─────────────────────────────────────────────────────────────────────────┤   │ │
│  │  │ 🗣️ 舆论演化模拟                                          状态: 🔄 67%  │   │ │
│  │  │    运行中...                                              [进入]       │   │ │
│  │  └─────────────────────────────────────────────────────────────────────────┘   │ │
│  │                                                                                 │ │
│  │  运行中模拟 (2)                                                                 │ │
│  │  ┌─────────────────────────────────────────────────────────────────────────┐   │ │
│  │  │ 🗣️ 舆论演化模拟                                     进度: ████████░░   │   │ │
│  │  │    第67天 / 100天                                   67%                │   │ │
│  │  │    [⏸️] [⏹️] [📊]                                                      │   │ │
│  │  ├─────────────────────────────────────────────────────────────────────────┤   │ │
│  │  │ 🏢 市场竞争分析                                     进度: ██████░░░░   │   │ │
│  │  │    第45天 / 90天                                    50%                │   │ │
│  │  │    [⏸️] [⏹️] [📊]                                                      │   │ │
│  │  └─────────────────────────────────────────────────────────────────────────┘   │ │
│  │                                                                                 │ │
│  │  ┌──────────┬──────────┬──────────┬──────────┬──────────┐                      │ │
│  │  │   🏠     │   🎬     │   👤     │   📊     │   ⚙️     │                      │ │
│  │  │  首页    │  场景    │  角色    │  分析    │  设置    │                      │ │
│  │  └──────────┴──────────┴──────────┴──────────┴──────────┘                      │ │
│  └─────────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                      │
│  适配策略:                                                                           │
│  • 底部固定导航栏替代侧边栏                                                           │
│  • 卡片式布局，单列显示                                                               │
│  • 复杂图表简化为关键指标                                                             │
│  • 触摸友好的按钮尺寸 (最小44px)                                                      │
│  • 手势操作支持 (滑动切换视图)                                                        │
│                                                                                      │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 8. 开发规范

### 8.1 代码规范

```typescript
// 组件文件结构规范
// Button.tsx
import React from 'react';
import { ButtonProps } from './Button.types';
import { useButtonStyles } from './Button.styles';

/**
 * Button组件 - 平台主要交互按钮
 * 
 * @example
 * <Button type="primary" onClick={handleClick}>
 *   确认
 * </Button>
 */
export const Button: React.FC<ButtonProps> = ({
  type = 'default',
  size = 'middle',
  loading = false,
  disabled = false,
  onClick,
  children,
  ...rest
}) => {
  const styles = useButtonStyles({ type, size });
  
  const handleClick = (e: React.MouseEvent) => {
    if (loading || disabled) return;
    onClick?.(e);
  };
  
  return (
    <button
      css={styles}
      disabled={disabled || loading}
      onClick={handleClick}
      {...rest}
    >
      {loading && <LoadingIcon />}
      {children}
    </button>
  );
};

// 命名规范
// 1. 组件: PascalCase (UserProfile)
// 2. Hooks: camelCase with 'use' prefix (useAuth)
// 3. 工具函数: camelCase (formatDate)
// 4. 常量: UPPER_SNAKE_CASE (API_BASE_URL)
// 5. 类型: PascalCase with suffix (UserProps, ConfigType)
// 6. 样式文件: ComponentName.styles.ts
// 7. 测试文件: ComponentName.test.tsx
```

### 8.2 测试策略

```typescript
// 组件测试示例
import { render, screen, fireEvent } from '@testing-library/react';
import { Button } from './Button';

describe('Button', () => {
  it('renders correctly', () => {
    render(<Button>Click me</Button>);
    expect(screen.getByText('Click me')).toBeInTheDocument();
  });

  it('handles click events', () => {
    const handleClick = jest.fn();
    render(<Button onClick={handleClick}>Click me</Button>);
    
    fireEvent.click(screen.getByText('Click me'));
    expect(handleClick).toHaveBeenCalledTimes(1);
  });

  it('shows loading state', () => {
    render(<Button loading>Loading</Button>);
    expect(screen.getByTestId('loading-icon')).toBeInTheDocument();
  });

  it('is disabled when loading', () => {
    render(<Button loading>Loading</Button>);
    expect(screen.getByRole('button')).toBeDisabled();
  });
});

// E2E测试示例 (Playwright)
import { test, expect } from '@playwright/test';

test('create scene workflow', async ({ page }) => {
  await page.goto('/dashboard');
  
  // 点击创建场景
  await page.click('text=创建场景');
  
  // 填写表单
  await page.fill('[name="name"]', '测试场景');
  await page.fill('[name="description"]', '这是一个测试场景');
  
  // 下一步
  await page.click('text=下一步');
  
  // 验证跳转
  await expect(page).toHaveURL(/\/scenes\/.*\/edit/);
});
```

---

## 9. 部署与构建

### 9.1 构建配置

```typescript
// vite.config.ts
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';
import { visualizer } from 'rollup-plugin-visualizer';

export default defineConfig(({ mode }) => ({
  plugins: [
    react(),
    mode === 'analyze' && visualizer({ open: true }),
  ],
  
  build: {
    target: 'es2020',
    outDir: 'dist',
    assetsDir: 'assets',
    
    // 代码分割
    rollupOptions: {
      output: {
        manualChunks: {
          // 第三方库分离
          vendor: ['react', 'react-dom', 'react-router-dom'],
          ui: ['antd', '@ant-design/icons'],
          visualization: ['d3', 'echarts', 'cytoscape'],
          state: ['zustand', '@tanstack/react-query'],
        },
      },
    },
    
    // 压缩配置
    minify: 'terser',
    terserOptions: {
      compress: {
        drop_console: true,
        drop_debugger: true,
      },
    },
    
    // 源码映射
    sourcemap: mode !== 'production',
  },
  
  // 开发服务器
  server: {
    port: 3000,
    proxy: {
      '/api': {
        target: 'http://localhost:8080',
        changeOrigin: true,
      },
    },
  },
  
  // 路径别名
  resolve: {
    alias: {
      '@': '/src',
      '@components': '/src/components',
      '@hooks': '/src/hooks',
      '@stores': '/src/stores',
      '@services': '/src/services',
      '@utils': '/src/utils',
      '@types': '/src/types',
    },
  },
}));
```

### 9.2 Docker配置

```dockerfile
# Dockerfile
FROM node:20-alpine AS builder

WORKDIR /app

# 安装依赖
COPY package.json pnpm-lock.yaml ./
RUN npm install -g pnpm && pnpm install --frozen-lockfile

# 复制源码
COPY . .

# 构建
RUN pnpm build

# 生产镜像
FROM nginx:alpine

# 复制构建产物
COPY --from=builder /app/dist /usr/share/nginx/html

# 复制nginx配置
COPY nginx.conf /etc/nginx/conf.d/default.conf

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
```

```nginx
# nginx.conf
server {
    listen 80;
    server_name localhost;
    root /usr/share/nginx/html;
    index index.html;

    # Gzip压缩
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_types text/plain text/css application/json application/javascript text/xml;

    # 缓存静态资源
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    # 前端路由支持
    location / {
        try_files $uri $uri/ /index.html;
    }

    # API代理
    location /api {
        proxy_pass http://backend:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

---

## 10. 附录

### A. 图标库

使用 `@ant-design/icons` + 自定义图标

```typescript
// 常用图标映射
export const iconMapping = {
  // 导航
  dashboard: 'DashboardOutlined',
  scenes: 'AppstoreOutlined',
  agents: 'TeamOutlined',
  simulation: 'PlayCircleOutlined',
  analytics: 'BarChartOutlined',
  settings: 'SettingOutlined',
  
  // 操作
  create: 'PlusOutlined',
  edit: 'EditOutlined',
  delete: 'DeleteOutlined',
  save: 'SaveOutlined',
  export: 'ExportOutlined',
  import: 'ImportOutlined',
  
  // 模拟控制
  play: 'PlayCircleOutlined',
  pause: 'PauseCircleOutlined',
  stop: 'StopOutlined',
  forward: 'ForwardOutlined',
  backward: 'BackwardOutlined',
  
  // 可视化
  network: 'ShareAltOutlined',
  timeline: 'FieldTimeOutlined',
  chart: 'LineChartOutlined',
  map: 'GlobalOutlined',
  
  // 状态
  success: 'CheckCircleOutlined',
  warning: 'ExclamationCircleOutlined',
  error: 'CloseCircleOutlined',
  info: 'InfoCircleOutlined',
  loading: 'LoadingOutlined',
};
```

### B. 第三方库清单

| 库名 | 版本 | 用途 |
|------|------|------|
| react | ^18.2.0 | UI框架 |
| antd | ^5.12.0 | UI组件库 |
| @ant-design/icons | ^5.2.0 | 图标库 |
| zustand | ^4.4.0 | 状态管理 |
| @tanstack/react-query | ^5.8.0 | 服务端状态 |
| axios | ^1.6.0 | HTTP客户端 |
| react-router-dom | ^6.20.0 | 路由 |
| d3 | ^7.8.0 | 数据可视化 |
| echarts | ^5.4.0 | 图表库 |
| cytoscape | ^3.26.0 | 网络图 |
| react-use-websocket | ^4.5.0 | WebSocket |
| dayjs | ^1.11.0 | 日期处理 |
| lodash-es | ^4.17.0 | 工具函数 |

### C. 性能预算

| 指标 | 目标值 | 警告阈值 |
|------|--------|---------|
| First Contentful Paint (FCP) | < 1.5s | > 2.0s |
| Largest Contentful Paint (LCP) | < 2.5s | > 3.5s |
| Time to Interactive (TTI) | < 3.5s | > 5.0s |
| Total Blocking Time (TBT) | < 200ms | > 500ms |
| Cumulative Layout Shift (CLS) | < 0.1 | > 0.25 |
| Bundle Size (initial) | < 500KB | > 800KB |
| Bundle Size (total) | < 2MB | > 3MB |
